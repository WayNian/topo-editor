<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>

<body>
    <script>
        const d = "M 4453.5 3443 L 4951.5 3443 L 4951.5 4153 L 5640 4153 L 5640 4968 L 4453.5 4968 Z"
        const parsePathD = (d) => {
            // ä½¿ç”¨æ­£åˆ™è¡¨è¾¾å¼åˆ†å‰²å‘½ä»¤ï¼ŒåŒæ—¶ä¿ç•™å‘½ä»¤å­—ç¬¦
            const commands = d.matchAll(/([a-zA-Z])(?:([+-]?\d+(?:\.\d+)?(?:e[+-]?\d+)?\s*,?\s*)+)/g);
            const pathSegments = [];

            for (const [, cmdTypeRaw, ...argsStr] of commands) {
                const cmdType = cmdTypeRaw.toUpperCase(); // è½¬æ¢ä¸ºå¤§å†™ä»¥ç»Ÿä¸€å¤„ç†
                const isRelative = cmdTypeRaw !== cmdType; // æ£€æŸ¥æ˜¯å¦ä¸ºå°å†™ï¼ˆç›¸å¯¹åæ ‡ï¼‰
                const args = argsStr.join(",").split(",").map(parseFloat); // åˆå¹¶å¹¶è§£æå‚æ•°
                console.log("ğŸš€ ~ parsePathD ~ argsStr:", argsStr)

                // æ ¹æ®å‘½ä»¤ç±»å‹åˆ›å»ºå¯¹åº”çš„å¯¹è±¡
                let segment = null;
                switch (cmdType) {
                    case "M": // MoveTo
                        segment = { type: "M", data: args, isRelative: isRelative };
                        break;
                    case "L": // LineTo
                        segment = { type: "L", data: args, isRelative: isRelative };
                        break;
                    case "H": // HorizontalLineTo
                        // H å‘½ä»¤åªæœ‰ä¸€ä¸ªå‚æ•°ï¼Œä»£è¡¨ x åæ ‡çš„å˜åŒ–
                        segment = { type: "H", data: [args[0]], isRelative: isRelative };
                        break;
                    case "V": // VerticalLineTo
                        // V å‘½ä»¤åªæœ‰ä¸€ä¸ªå‚æ•°ï¼Œä»£è¡¨ y åæ ‡çš„å˜åŒ–
                        segment = { type: "V", data: [args[0]], isRelative: isRelative };
                        break;
                    case "C": // CurveTo
                        // C å‘½ä»¤æœ‰ 6 ä¸ªå‚æ•°ï¼Œä»£è¡¨ä¸‰æ¬¡è´å¡å°”æ›²çº¿çš„æ§åˆ¶ç‚¹å’Œç»“æŸç‚¹
                        segment = { type: "C", data: args, isRelative: isRelative };
                        break;
                    case "S": // SmoothCurveTo
                        // S å‘½ä»¤æœ‰ 4 ä¸ªå‚æ•°ï¼Œä»£è¡¨å¹³æ»‘ä¸‰æ¬¡è´å¡å°”æ›²çº¿çš„ç¬¬äºŒä¸ªæ§åˆ¶ç‚¹å’Œç»“æŸç‚¹
                        segment = { type: "S", data: args, isRelative: isRelative };
                        break;
                    case "Q": // QuadraticBezierCurveTo
                        // Q å‘½ä»¤æœ‰ 4 ä¸ªå‚æ•°ï¼Œä»£è¡¨äºŒæ¬¡è´å¡å°”æ›²çº¿çš„æ§åˆ¶ç‚¹å’Œç»“æŸç‚¹
                        segment = { type: "Q", data: args, isRelative: isRelative };
                        break;
                    case "T": // SmoothQuadraticBezierCurveTo
                        // T å‘½ä»¤æœ‰ 2 ä¸ªå‚æ•°ï¼Œä»£è¡¨å¹³æ»‘äºŒæ¬¡è´å¡å°”æ›²çº¿çš„ç»“æŸç‚¹
                        segment = { type: "T", data: args, isRelative: isRelative };
                        break;
                    case "A": // ArcTo
                        // A å‘½ä»¤æœ‰ 7 ä¸ªæˆ–æ›´å¤šå‚æ•°ï¼Œä»£è¡¨æ¤­åœ†å¼§
                        segment = { type: "A", data: args, isRelative: isRelative };
                        break;
                    case "Z": // ClosePath
                        // Z å‘½ä»¤æ²¡æœ‰å‚æ•°ï¼Œè¡¨ç¤ºé—­åˆè·¯å¾„
                        segment = { type: "Z", data: [], isRelative: false };
                        break;
                    default:
                        // å¯¹äºä¸æ”¯æŒçš„å‘½ä»¤ï¼Œå¯ä»¥é€‰æ‹©å¿½ç•¥æˆ–æŠ›å‡ºé”™è¯¯
                        console.warn(`Unsupported command: ${cmdTypeRaw}`);
                        continue;
                }

                // å°†è§£æçš„æ®µæ·»åŠ åˆ°è·¯å¾„æ®µæ•°ç»„ä¸­
                if (segment) {
                    console.log("ğŸš€ ~ parsePathD ~ segment:", segment);
                    pathSegments.push(segment);
                }
            }

            console.log("ğŸš€ ~ parsePathD ~ pathSegments:", d, pathSegments);

            return pathSegments;
        };

        const res = parsePathD(d)
        console.log(res);
    </script>
</body>

</html>